import{u as T,r as x,j as e,H as R}from"./app-CrR2e6si.js";import{A as M}from"./app-layout-BlBsKGdN.js";import{B as f}from"./button-TAkYr07m.js";import{I as u}from"./input-DyR6yKAK.js";import{T as S}from"./textarea-BSwCwaMA.js";import{L as n}from"./label-CqnHdu-e.js";import{S as E}from"./switch-DBf-5lju.js";import{C as v,a as _,b as N,c as b}from"./card-C4Ze9f0h.js";import{B as d}from"./badge-xFiofwbL.js";import{C as $}from"./checkbox--b9gynK0.js";import{H as P}from"./heart-DjX03O1m.js";import{V}from"./video-BhSqQus5.js";import{U as z}from"./upload-CRwMzx92.js";import{E as O}from"./external-link-BqZ6Sbhq.js";import{I as q}from"./image-LVo2oCVD.js";/* empty css            */import"./index-DIhEDuut.js";import"./index-Cp7DFzk1.js";import"./index-MGpkUcMS.js";import"./check-D3rtSHKw.js";function xe({story:a,translations:o,mediaItems:m,attachedMediaIds:h}){const I=[{title:"Stories of Hope",href:"/stories"},{title:"Edit",href:`/stories/${a.id}/edit`}],{data:r,setData:l,post:U,processing:y,errors:t}=T({_method:"PUT",title_en:o.title_en||"",title_ar:o.title_ar||"",description_en:o.description_en||"",description_ar:o.description_ar||"",background_image:null,external_url:a.external_url||"",is_active:a.is_active,is_featured:a.is_featured,media_ids:h}),[D,p]=x.useState([]),[g,k]=x.useState(null),[w,C]=x.useState(a.background_image_path?`/storage/${a.background_image_path}`:null);x.useEffect(()=>{const s=m.filter(i=>h.includes(i.id));p(s)},[m,h]);const L=(s,i)=>{i?(p(c=>[...c,s]),l("media_ids",[...r.media_ids,s.id])):(p(c=>c.filter(j=>j.id!==s.id)),l("media_ids",r.media_ids.filter(c=>c!==s.id)))},B=s=>{const i=s.target.files?.[0];if(i){l("background_image",i);const c=new FileReader;c.onload=j=>{k(j.target?.result),C(null)},c.readAsDataURL(i)}},F=()=>{l("background_image",null),k(null),C(a.background_image_path?`/storage/${a.background_image_path}`:null);const s=document.getElementById("background_image");s&&(s.value="")},A=s=>{s.preventDefault(),U(`/stories/${a.id}`)},H=(s,i)=>s==="video"?e.jsx(V,{className:"w-4 h-4"}):i==="upload"?e.jsx(z,{className:"w-4 h-4"}):i==="external_link"?e.jsx(O,{className:"w-4 h-4"}):e.jsx(q,{className:"w-4 h-4"});return e.jsxs(M,{breadcrumbs:I,children:[e.jsx(R,{title:`Edit Story - ${o.title_en||"Untitled"}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Edit Story of Hope"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update story details and settings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",className:"font-mono",children:["#",a.story_id]}),e.jsx(d,{variant:r.is_active?"default":"secondary",children:r.is_active?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 max-w-7xl",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs(v,{className:"overflow-hidden",children:[e.jsx(_,{className:"px-6 py-4 border-b",children:e.jsxs(N,{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-red-500"}),"Story Information"]})}),e.jsx(b,{className:"p-6",children:e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"title_en",children:"Title (English) *"}),e.jsx(u,{id:"title_en",type:"text",placeholder:"Story title in English",value:r.title_en,onChange:s=>l("title_en",s.target.value),className:t.title_en?"border-destructive":""}),t.title_en&&e.jsx("p",{className:"text-sm text-destructive",children:t.title_en})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"title_ar",children:"Title (Arabic) *"}),e.jsx(u,{id:"title_ar",type:"text",placeholder:"عنوان القصة بالعربية",value:r.title_ar,onChange:s=>l("title_ar",s.target.value),className:t.title_ar?"border-destructive":"",dir:"rtl"}),t.title_ar&&e.jsx("p",{className:"text-sm text-destructive",children:t.title_ar})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"description_en",children:"Description (English) *"}),e.jsx(S,{id:"description_en",placeholder:"Tell the inspiring story in English",value:r.description_en,onChange:s=>l("description_en",s.target.value),rows:6,className:t.description_en?"border-destructive":""}),t.description_en&&e.jsx("p",{className:"text-sm text-destructive",children:t.description_en})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"description_ar",children:"Description (Arabic) *"}),e.jsx(S,{id:"description_ar",placeholder:"احكِ القصة الملهمة بالعربية",value:r.description_ar,onChange:s=>l("description_ar",s.target.value),rows:6,className:t.description_ar?"border-destructive":"",dir:"rtl"}),t.description_ar&&e.jsx("p",{className:"text-sm text-destructive",children:t.description_ar})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"background_image",children:"Background Image"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{id:"background_image",type:"file",accept:"image/*",onChange:B,className:t.background_image?"border-destructive":""}),t.background_image&&e.jsx("p",{className:"text-sm text-destructive",children:t.background_image}),w&&!g&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w,alt:"Current background",className:"w-full h-48 object-cover rounded-lg border"}),e.jsx(d,{variant:"secondary",className:"absolute top-2 left-2",children:"Current Image"})]}),g&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:g,alt:"New background preview",className:"w-full h-48 object-cover rounded-lg border"}),e.jsx(d,{variant:"default",className:"absolute top-2 left-2",children:"New Image"}),e.jsx(f,{type:"button",onClick:F,variant:"destructive",size:"sm",className:"absolute top-2 right-2",children:"Remove"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{htmlFor:"external_url",children:"External URL (Optional)"}),e.jsx(u,{id:"external_url",type:"url",placeholder:"https://example.com/full-story",value:r.external_url,onChange:s=>l("external_url",s.target.value),className:t.external_url?"border-destructive":""}),t.external_url&&e.jsx("p",{className:"text-sm text-destructive",children:t.external_url}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Link to the full story or external source"})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-3 py-2",children:[e.jsx(E,{checked:r.is_active,onCheckedChange:s=>l("is_active",s)}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium leading-none",children:"Active Story"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Make this story visible in the system"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 py-2",children:[e.jsx(E,{checked:r.is_featured,onCheckedChange:s=>l("is_featured",s)}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium leading-none",children:"Featured Story"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Make this story featured on the aid efforts page"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>window.history.back(),children:"Cancel"}),e.jsx(f,{type:"submit",disabled:y,className:"gap-2",children:y?"Updating...":"Update Story"})]})]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(v,{children:[e.jsx(_,{className:"px-6 py-4 border-b",children:e.jsx(N,{className:"text-lg font-semibold",children:"Story Info"})}),e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Story ID:"}),e.jsx("span",{className:"font-mono",children:a.story_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"URL Slug:"}),e.jsx("span",{className:"font-mono text-xs",children:a.url_slug})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{children:new Date(a.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Updated:"}),e.jsx("span",{children:new Date(a.updated_at).toLocaleDateString()})]})]})})]}),e.jsxs(v,{children:[e.jsx(_,{className:"px-6 py-4 border-b",children:e.jsxs(N,{className:"text-lg font-semibold",children:["Attach Media (",D.length," selected)"]})}),e.jsx(b,{className:"p-6",children:e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:m.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No media items available"}):m.map(s=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 border rounded",children:[e.jsx($,{checked:r.media_ids.includes(s.id),onCheckedChange:i=>L(s,!!i)}),e.jsx("div",{className:"w-12 h-12 bg-muted rounded flex items-center justify-center overflow-hidden",children:s.thumbnail||s.url?e.jsx("img",{src:s.thumbnail||s.url,alt:s.title.en,className:"w-full h-full object-cover"}):H(s.type,s.source_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title.en||s.media_id}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(d,{variant:"outline",className:"text-xs",children:s.type}),e.jsx(d,{variant:"secondary",className:"text-xs",children:s.source_type})]})]})]},s.id))})})]})]})]})]})]})}export{xe as default};
