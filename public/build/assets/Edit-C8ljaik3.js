import{u as O,r as b,j as e,H as R}from"./app-kFe3W52v.js";import{A as M,X as P}from"./app-layout-CeMAjsTz.js";import{B as y}from"./button-CjP7rKh3.js";import{I as n}from"./input-BgsbDBET.js";import{L as l}from"./label-XQbIVQar.js";import{T as S}from"./textarea-Dhir0lO2.js";import{S as F}from"./switch-AC4QBrbB.js";import{C as x,a as u,b as h,c as p}from"./card-C2Q4dehj.js";import{B as g}from"./badge-f65TfQO7.js";import{C as z}from"./checkbox-BKqEJ5F5.js";import{E as H}from"./external-link-oqV1Dx5r.js";import{U as T}from"./upload-CvK2Jdnd.js";import{U}from"./user-v3t22cTd.js";import{M as V}from"./map-pin-Bz-tpcHY.js";import{C as Y}from"./calendar-0dC7J0Oc.js";import{V as D}from"./video-BjFbVYHU.js";import{I as w}from"./image-g7Ln0GRp.js";/* empty css            */import"./index-DM-IqmN2.js";import"./index-DGqGJZ-A.js";import"./index-CMYKVjK-.js";import"./check-tbrJmj50.js";function he({testimony:r,translations:o,availableMedia:v,attachedMedia:f}){const E=[{title:"Testimonies",href:"/testimonies"},{title:"Edit",href:`/testimonies/${r.id}/edit`}],{data:t,setData:i,post:B,processing:k,errors:a}=O({_method:"PUT",category_en:o.category_en||"",category_ar:o.category_ar||"",title_en:o.title_en||"",title_ar:o.title_ar||"",description_en:o.description_en||"",description_ar:o.description_ar||"",survivor_name:r.survivor_name||"",survivor_age:r.survivor_age?.toString()||"",survivor_location:r.survivor_location||"",date_of_incident:r.date_of_incident||"",background_image:null,url_slug:r.url_slug,is_featured:r.is_featured,is_active:r.is_active,media_ids:f}),[j,C]=b.useState(null),[m,_]=b.useState([]);b.useEffect(()=>{r.background_image_path&&C(`/storage/${r.background_image_path}`);const s=v.filter(c=>f.includes(c.id));_(s)},[r,v,f]);const L=s=>{const c=s.target.files?.[0];if(c){i("background_image",c);const d=new FileReader;d.onload=N=>C(N.target?.result),d.readAsDataURL(c)}},I=(s,c)=>{c?(_(d=>[...d,s]),i("media_ids",[...t.media_ids,s.id])):(_(d=>d.filter(N=>N.id!==s.id)),i("media_ids",t.media_ids.filter(d=>d!==s.id)))},A=s=>{_(c=>c.filter(d=>d.id!==s)),i("media_ids",t.media_ids.filter(c=>c!==s))},$=s=>{s.preventDefault(),B(`/testimonies/${r.id}`)};return e.jsxs(M,{breadcrumbs:E,children:[e.jsx(R,{title:`Edit Testimony - ${o.title_en||"Untitled"}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Edit Testimony"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update testimony details and content"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"outline",children:r.testimony_id}),r.is_featured&&e.jsx(g,{variant:"default",children:"Featured"}),!r.is_active&&e.jsx(g,{variant:"destructive",children:"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 max-w-7xl",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(x,{className:"overflow-hidden",children:[e.jsx(u,{className:"px-6 py-4 border-b",children:e.jsx(h,{className:"text-lg font-semibold",children:"Testimony Details"})}),e.jsx(p,{className:"p-6",children:e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Survivor Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"survivor_name",children:"Name (Optional)"}),e.jsx(n,{id:"survivor_name",type:"text",placeholder:"Survivor's name",value:t.survivor_name,onChange:s=>i("survivor_name",s.target.value),className:a.survivor_name?"border-destructive":""}),a.survivor_name&&e.jsx("p",{className:"text-sm text-destructive",children:a.survivor_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"survivor_age",children:"Age (Optional)"}),e.jsx(n,{id:"survivor_age",type:"number",placeholder:"Age",min:"1",max:"150",value:t.survivor_age,onChange:s=>i("survivor_age",s.target.value),className:a.survivor_age?"border-destructive":""}),a.survivor_age&&e.jsx("p",{className:"text-sm text-destructive",children:a.survivor_age})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"survivor_location",children:"Location (Optional)"}),e.jsx(n,{id:"survivor_location",type:"text",placeholder:"Location",value:t.survivor_location,onChange:s=>i("survivor_location",s.target.value),className:a.survivor_location?"border-destructive":""}),a.survivor_location&&e.jsx("p",{className:"text-sm text-destructive",children:a.survivor_location})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"date_of_incident",children:"Incident Date (Optional)"}),e.jsx(n,{id:"date_of_incident",type:"date",value:t.date_of_incident,onChange:s=>i("date_of_incident",s.target.value),className:a.date_of_incident?"border-destructive":""}),a.date_of_incident&&e.jsx("p",{className:"text-sm text-destructive",children:a.date_of_incident})]})]}),r.background_image_path&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{children:"Current Background Image"}),e.jsx("div",{className:"border rounded-lg p-4 bg-muted/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded overflow-hidden",children:e.jsx("img",{src:`/storage/${r.background_image_path}`,alt:"Current background",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current background image"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.background_image_path})]}),e.jsx("a",{href:`/storage/${r.background_image_path}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded hover:bg-muted",children:e.jsx(H,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(l,{children:[r.background_image_path?"Replace Background Image":"Background Image"," (Optional)"]}),e.jsx("div",{className:"border-2 border-dashed border-border rounded-lg p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[j&&t.background_image?e.jsxs("div",{className:"space-y-3",children:[e.jsx("img",{src:j,alt:"New background preview",className:"mx-auto max-h-32 rounded"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["New: ",t.background_image?.name]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"mx-auto h-8 w-8 text-muted-foreground"}),e.jsx("p",{className:"text-sm",children:r.background_image_path?"Upload a new background image to replace the current one":"Upload a background image"})]}),e.jsx("input",{type:"file",onChange:L,accept:"image/*",className:"sr-only",id:"background-upload"}),e.jsxs(l,{htmlFor:"background-upload",className:"cursor-pointer inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:[e.jsx(T,{className:"w-4 h-4"}),r.background_image_path?"Replace Background":"Choose Background"]})]})}),a.background_image&&e.jsx("p",{className:"text-sm text-destructive",children:a.background_image})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Content"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"English Content"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{htmlFor:"category_en",children:"Category (Optional)"}),e.jsx(n,{id:"category_en",type:"text",placeholder:"e.g., Survivor Story",value:t.category_en,onChange:s=>i("category_en",s.target.value),className:a.category_en?"border-destructive":""}),a.category_en&&e.jsx("p",{className:"text-sm text-destructive",children:a.category_en})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{htmlFor:"title_en",children:"Title *"}),e.jsx(n,{id:"title_en",type:"text",placeholder:"Enter English title",value:t.title_en,onChange:s=>i("title_en",s.target.value),className:a.title_en?"border-destructive":""}),a.title_en&&e.jsx("p",{className:"text-sm text-destructive",children:a.title_en})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{htmlFor:"description_en",children:"Description *"}),e.jsx(S,{id:"description_en",placeholder:"Enter English description",value:t.description_en,onChange:s=>i("description_en",s.target.value),rows:6,className:a.description_en?"border-destructive":""}),a.description_en&&e.jsx("p",{className:"text-sm text-destructive",children:a.description_en})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Arabic Content"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{htmlFor:"category_ar",children:"Category (Optional)"}),e.jsx(n,{id:"category_ar",type:"text",placeholder:"مثال: قصة ناجي",value:t.category_ar,onChange:s=>i("category_ar",s.target.value),className:a.category_ar?"border-destructive":"",dir:"rtl"}),a.category_ar&&e.jsx("p",{className:"text-sm text-destructive",children:a.category_ar})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{htmlFor:"title_ar",children:"Title *"}),e.jsx(n,{id:"title_ar",type:"text",placeholder:"أدخل العنوان بالعربية",value:t.title_ar,onChange:s=>i("title_ar",s.target.value),className:a.title_ar?"border-destructive":"",dir:"rtl"}),a.title_ar&&e.jsx("p",{className:"text-sm text-destructive",children:a.title_ar})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{htmlFor:"description_ar",children:"Description *"}),e.jsx(S,{id:"description_ar",placeholder:"أدخل الوصف بالعربية",value:t.description_ar,onChange:s=>i("description_ar",s.target.value),rows:6,className:a.description_ar?"border-destructive":"",dir:"rtl"}),a.description_ar&&e.jsx("p",{className:"text-sm text-destructive",children:a.description_ar})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{htmlFor:"url_slug",children:"URL Slug *"}),e.jsx(n,{id:"url_slug",type:"text",placeholder:"testimony-url-slug",value:t.url_slug,onChange:s=>i("url_slug",s.target.value),className:`font-mono ${a.url_slug?"border-destructive":""}`}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["URL: /testimonies/",t.url_slug]}),a.url_slug&&e.jsx("p",{className:"text-sm text-destructive",children:a.url_slug})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 py-2",children:[e.jsx(F,{checked:t.is_featured,onCheckedChange:s=>i("is_featured",s)}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium leading-none",children:"Featured Testimony"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Show this testimony on the home page"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 py-2",children:[e.jsx(F,{checked:t.is_active,onCheckedChange:s=>i("is_active",s)}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium leading-none",children:"Active"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Make this testimony visible on the site"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(y,{type:"button",variant:"outline",onClick:()=>window.history.back(),children:"Cancel"}),e.jsx(y,{type:"submit",disabled:k,className:"gap-2",children:k?"Updating...":"Update Testimony"})]})]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(x,{children:[e.jsx(u,{className:"px-6 py-4 border-b",children:e.jsx(h,{className:"text-lg font-semibold",children:"Preview"})}),e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"aspect-[4/3] bg-muted rounded-lg flex items-center justify-center",children:j?e.jsx("img",{src:j,alt:"Background preview",className:"w-full h-full object-cover rounded-lg"}):e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(U,{className:"mx-auto w-8 h-8 mb-2"}),e.jsx("p",{className:"text-sm",children:"No background image"})]})}),e.jsxs("div",{className:"space-y-2",children:[t.category_en&&e.jsx(g,{variant:"outline",className:"text-xs",children:t.category_en}),e.jsx("h3",{className:"font-medium text-sm",children:t.title_en||"Title will appear here"}),t.description_en&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:t.description_en})]}),(t.survivor_name||t.survivor_location||t.date_of_incident)&&e.jsxs("div",{className:"space-y-1 pt-2 border-t",children:[t.survivor_name&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(U,{className:"w-3 h-3"}),t.survivor_name,t.survivor_age&&`, ${t.survivor_age} years old`]}),t.survivor_location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(V,{className:"w-3 h-3"}),t.survivor_location]}),t.date_of_incident&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Y,{className:"w-3 h-3"}),new Date(t.date_of_incident).toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Featured:"}),e.jsx("span",{children:t.is_featured?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Active:"}),e.jsx("span",{children:t.is_active?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Media:"}),e.jsxs("span",{children:[m.length," item",m.length!==1?"s":""]})]})]})]})})]}),m.length>0&&e.jsxs(x,{children:[e.jsx(u,{className:"px-6 py-4 border-b",children:e.jsxs(h,{className:"text-lg font-semibold",children:["Selected Media (",m.length,")"]})}),e.jsx(p,{className:"p-6",children:e.jsx("div",{className:"space-y-3",children:m.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded",children:[e.jsx("div",{className:"w-12 h-12 bg-muted rounded overflow-hidden",children:s.thumbnail||s.url?e.jsx("img",{src:s.thumbnail||s.url,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.type==="video"?e.jsx(D,{className:"w-4 h-4 text-muted-foreground"}):e.jsx(w,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.type})]}),e.jsx(y,{type:"button",variant:"outline",size:"sm",onClick:()=>A(s.id),className:"h-8 w-8 p-0",children:e.jsx(P,{className:"w-4 h-4"})})]},s.id))})})]}),e.jsxs(x,{children:[e.jsxs(u,{className:"px-6 py-4 border-b",children:[e.jsx(h,{className:"text-lg font-semibold",children:"Media Gallery"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select media to attach to this testimony"})]}),e.jsx(p,{className:"p-6",children:e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-3",children:v.length>0?v.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2",children:[e.jsx(z,{checked:t.media_ids.includes(s.id),onCheckedChange:c=>I(s,!!c)}),e.jsx("div",{className:"w-12 h-12 bg-muted rounded overflow-hidden",children:s.thumbnail||s.url?e.jsx("img",{src:s.thumbnail||s.url,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.type==="video"?e.jsx(D,{className:"w-4 h-4 text-muted-foreground"}):e.jsx(w,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{variant:"outline",className:"text-xs capitalize",children:s.type}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.media_id})]})]})]},s.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(w,{className:"mx-auto w-8 h-8 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No media available. Create some media first."})]})})})]}),e.jsxs(x,{children:[e.jsx(u,{className:"px-6 py-4 border-b",children:e.jsx(h,{className:"text-lg font-semibold",children:"Testimony Info"})}),e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"ID:"}),e.jsx("span",{className:"font-mono",children:r.testimony_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{children:new Date(r.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Updated:"}),e.jsx("span",{children:new Date(r.updated_at).toLocaleDateString()})]})]})})]})]})]})]})]})}export{he as default};
