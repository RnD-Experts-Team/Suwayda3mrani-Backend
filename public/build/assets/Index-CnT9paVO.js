import{r as n,a as m,j as e,H as me,L as f}from"./app-CrR2e6si.js";import{A as xe}from"./app-layout-BlBsKGdN.js";import{B as l}from"./button-TAkYr07m.js";import{I as he}from"./input-DyR6yKAK.js";import{S as ue,a as fe,b as pe,c as je,d as w}from"./select-2URgjTAn.js";import{B as b}from"./badge-xFiofwbL.js";import{C as p,a as ge,b as Ne,c as j}from"./card-C4Ze9f0h.js";import{C as L}from"./checkbox--b9gynK0.js";import{A as E,a as R,b as U,c as V,d as H,e as q,f as M,g as W}from"./alert-dialog-C6LKY8gG.js";import{P as ve,a as _e,b as we,c as be,d as Ce,e as Se}from"./pagination-sLZUPq_E.js";import{T as C}from"./trash-2-BDp1U-OY.js";import{P as G}from"./plus-DKUScZbf.js";import{F as ye}from"./filter-C412sp25.js";import{R as J}from"./rotate-ccw-QPJI7gRv.js";import{S as K}from"./search-B6v_5Gqc.js";import{S as De,a as Te}from"./star-BnUoeddg.js";import{U as S}from"./user-uMJOBb_l.js";import{I as Fe}from"./image-LVo2oCVD.js";import{M as ke}from"./map-pin-B-6LJAuz.js";import{C as Ae}from"./calendar-DJjfRyov.js";import{E as Ie}from"./eye-B4jGMgjg.js";import{S as Pe}from"./square-pen-Dcisaaj3.js";/* empty css            */import"./index-DIhEDuut.js";import"./index-Cp7DFzk1.js";import"./index-MGpkUcMS.js";import"./check-D3rtSHKw.js";import"./chevron-left-C5l6EbmX.js";const Oe=[{title:"Testimonies",href:"/testimonies"}];function os(Q){const{testimonies:i=null,filters:X=null}=Q||{},a={data:i?.data||[],links:i?.links||[],meta:{current_page:i?.current_page||1,last_page:i?.last_page||1,per_page:i?.per_page||12,total:i?.total||0,from:i?.from||null,to:i?.to||null}},y=X||{},[c,D]=n.useState(y.search||""),[h,T]=n.useState(y.featured||"__all__"),[r,x]=n.useState([]),[Y,g]=n.useState(!1),[Z,N]=n.useState(!1),[F,k]=n.useState(null),[ee,se]=n.useState(!0);n.useEffect(()=>{if(ee){se(!1);return}const s=setTimeout(()=>{I()},300);return()=>clearTimeout(s)},[c]);const A=s=>s==="__all__"?"":s,I=()=>{const s={};c?.trim()&&(s.search=c.trim());const t=A(h);t&&(s.featured=t),m.get("/testimonies",Object.keys(s).length>0?s:{},{preserveState:!0,preserveScroll:!0})},te=(s={})=>{const t={},d=s.search!==void 0?s.search:c,_=s.featured!==void 0?s.featured:h;d?.trim()&&(t.search=d.trim());const B=A(_);B&&(t.featured=B),m.get("/testimonies",Object.keys(t).length>0?t:{},{preserveState:!0,preserveScroll:!0})},P=()=>{D(""),T("__all__"),m.get("/testimonies")},ae=s=>{s&&a.data.length>0?x(a.data.map(t=>t.id)):x([])},le=(s,t)=>{x(t?d=>[...d,s]:d=>d.filter(_=>_!==s))},re=s=>{k(s),g(!0)},ie=()=>{F&&m.delete(`/testimonies/${F}`),g(!1),k(null)},O=()=>{N(!0)},ne=()=>{r.length>0&&m.post("/testimonies/bulk-delete",{ids:r}),N(!1),x([])},ce=s=>{m.patch(`/testimonies/${s.id}/toggle-featured`,{},{preserveState:!0,preserveScroll:!0})},o=!!(c?.trim()||h!=="__all__");a.data.length>0;const v=a.meta.total===0,u=a.meta.total,$=a.meta.from,z=a.meta.to,oe=()=>v&&!o?"No testimonies found. Create your first testimony to get started.":v&&o?"No results match your current filters.":$&&z?`Showing ${$} to ${z} of ${u} results`:u>0?`${u} testimon${u!==1?"ies":"y"}`:"Loading testimonies...",de=()=>e.jsx(p,{className:"overflow-hidden",children:e.jsx(j,{className:"py-16",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center",children:e.jsx(S,{className:"w-8 h-8 text-muted-foreground"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:o?"No testimonies found":"No testimonies yet"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:o?"Try adjusting your filters to find what you're looking for.":"Create your first testimony to share survivor stories."})]}),e.jsxs("div",{className:"flex justify-center gap-2 pt-4",children:[o&&e.jsxs(l,{variant:"outline",onClick:P,className:"gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"Clear Filters"]}),e.jsx(f,{href:"/testimonies/create",children:e.jsxs(l,{className:"gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Create Testimony"]})})]})]})})});return e.jsxs(xe,{breadcrumbs:Oe,children:[e.jsx(me,{title:"Testimonies"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Testimonies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:oe()})]}),e.jsxs("div",{className:"flex gap-2",children:[r.length>0&&e.jsxs(l,{variant:"destructive",onClick:O,size:"sm",className:"gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Delete Selected (",r.length,")"]}),e.jsx(f,{href:"/testimonies/create",children:e.jsxs(l,{size:"sm",className:"gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Create Testimony"]})})]})]}),e.jsxs(p,{className:"overflow-hidden",children:[e.jsx(ge,{className:"px-6 py-4 border-b",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(Ne,{className:"text-lg font-semibold",children:"Filters"})]}),o&&e.jsxs(l,{variant:"outline",size:"sm",onClick:P,className:"gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"Clear Filters"]})]})}),e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(he,{type:"text",placeholder:"Search testimonies...",value:c,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsxs(ue,{value:h,onValueChange:s=>{T(s),te({featured:s})},children:[e.jsx(fe,{children:e.jsx(pe,{placeholder:"All Testimonies"})}),e.jsxs(je,{children:[e.jsx(w,{value:"__all__",children:"All Testimonies"}),e.jsx(w,{value:"true",children:"Featured Only"}),e.jsx(w,{value:"false",children:"Not Featured"})]})]}),e.jsxs(l,{onClick:I,className:"gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Search"]})]})})]}),v?e.jsx(de,{}):e.jsxs(e.Fragment,{children:[r.length>0&&e.jsx(p,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{checked:r.length===a.data.length&&a.data.length>0,onCheckedChange:ae}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[r.length," of ",a.data.length," selected"]})]}),e.jsxs(l,{variant:"destructive",size:"sm",onClick:O,className:"gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Delete Selected"]})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.data.map(s=>e.jsxs(p,{className:"overflow-hidden group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx(L,{checked:r.includes(s.id),onCheckedChange:t=>le(s.id,!!t)})}),e.jsx("button",{onClick:()=>ce(s),className:"absolute top-3 right-3 z-10 p-1 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition-opacity",children:s.is_featured?e.jsx(De,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}):e.jsx(Te,{className:"w-4 h-4"})}),e.jsx("div",{className:"aspect-[4/3] bg-muted flex items-center justify-center",children:s.translated_content.imageUrl?e.jsx("img",{src:s.translated_content.imageUrl,alt:s.translated_content.title?.en||"Testimony",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[e.jsx(S,{className:"w-8 h-8"}),e.jsx("span",{className:"text-xs",children:"No image"})]})}),s.media_count>0&&e.jsx("div",{className:"absolute bottom-3 left-3",children:e.jsxs(b,{variant:"secondary",className:"gap-1",children:[e.jsx(Fe,{className:"w-3 h-3"}),s.media_count]})})]}),e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[s.translated_content.category?.en&&e.jsx(b,{variant:"outline",className:"text-xs",children:s.translated_content.category.en}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-2",children:s.translated_content.title?.en||"Untitled"}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:s.translated_content.description?.en||"No description"}),e.jsxs("div",{className:"space-y-1",children:[s.survivor_name&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(S,{className:"w-3 h-3"}),s.survivor_name,s.survivor_age&&`, ${s.survivor_age} years old`]}),s.survivor_location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(ke,{className:"w-3 h-3"}),s.survivor_location]}),s.date_of_incident&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Ae,{className:"w-3 h-3"}),new Date(s.date_of_incident).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx(f,{href:`/testimonies/${s.id}`,children:e.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Ie,{className:"w-4 h-4"})})}),e.jsx(f,{href:`/testimonies/${s.id}/edit`,children:e.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Pe,{className:"w-4 h-4"})})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>re(s.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:e.jsx(C,{className:"w-4 h-4"})})]}),s.is_featured&&e.jsx(b,{variant:"default",className:"text-xs",children:"Featured"})]})]})})]},s.id))}),a.meta.last_page>1&&e.jsx("div",{className:"flex justify-center",children:e.jsx(ve,{children:e.jsx(_e,{children:a.links.map((s,t)=>e.jsx(we,{children:s.label==="&laquo; Previous"?e.jsx(be,{href:s.url||"#",className:s.url?"":"pointer-events-none opacity-50"}):s.label==="Next &raquo;"?e.jsx(Ce,{href:s.url||"#",className:s.url?"":"pointer-events-none opacity-50"}):e.jsx(Se,{href:s.url||"#",isActive:s.active,className:s.url?"":"pointer-events-none opacity-50",children:s.label})},t))})})})]})]}),e.jsx(E,{open:Y,onOpenChange:g,children:e.jsxs(R,{children:[e.jsxs(U,{children:[e.jsx(V,{children:"Are you sure?"}),e.jsx(H,{children:"This action cannot be undone. This will permanently delete the testimony and all associated content."})]}),e.jsxs(q,{children:[e.jsx(M,{children:"Cancel"}),e.jsx(W,{onClick:ie,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(E,{open:Z,onOpenChange:N,children:e.jsxs(R,{children:[e.jsxs(U,{children:[e.jsxs(V,{children:["Delete ",r.length," testimonies?"]}),e.jsx(H,{children:"This action cannot be undone. This will permanently delete the selected testimonies and all associated content."})]}),e.jsxs(q,{children:[e.jsx(M,{children:"Cancel"}),e.jsx(W,{onClick:ne,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete All"})]})]})})]})}export{os as default};
