import{r as u,j as e,H as fe,L as ve,a as B}from"./app-CrR2e6si.js";import{c as Q,R as ge,u as je,a as X,P as Ne,h as be,b as ye,d as Ce,F as Pe,D as _e,C as we,e as Ae,A as Se,f as z}from"./app-layout-BlBsKGdN.js";import{c as Re,u as Y,a as Oe,b as Fe,B as x}from"./button-TAkYr07m.js";import{I as G}from"./input-DyR6yKAK.js";import{S as J,a as K,b as U,c as q,d as v,C as Ee}from"./select-2URgjTAn.js";import{B as P}from"./badge-xFiofwbL.js";import{C as M,c as $}from"./card-C4Ze9f0h.js";import{C as O}from"./checkbox--b9gynK0.js";import{L as F}from"./label-CqnHdu-e.js";import{u as ke,c as De,a as A,P as ee}from"./index-DIhEDuut.js";import{P as se}from"./index-Cp7DFzk1.js";import{F as Ie}from"./filter-C412sp25.js";import{R as W}from"./rotate-ccw-QPJI7gRv.js";import{F as Le}from"./file-text-DRpMn7iA.js";import{M as Me}from"./map-pin-B-6LJAuz.js";import{E as $e}from"./eye-B4jGMgjg.js";import{C as Z}from"./chevron-left-C5l6EbmX.js";/* empty css            */import"./index-MGpkUcMS.js";import"./check-D3rtSHKw.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],He=Re("Download",Te);var E="Popover",[te,_s]=De(E,[Q]),S=Q(),[Ve,j]=te(E),re=r=>{const{__scopePopover:l,children:n,open:c,defaultOpen:t,onOpenChange:a,modal:i=!1}=r,d=S(l),h=u.useRef(null),[N,C]=u.useState(!1),[b,f]=ke({prop:c,defaultProp:t??!1,onChange:a,caller:E});return e.jsx(ge,{...d,children:e.jsx(Ve,{scope:l,contentId:je(),triggerRef:h,open:b,onOpenChange:f,onOpenToggle:u.useCallback(()=>f(g=>!g),[f]),hasCustomAnchor:N,onCustomAnchorAdd:u.useCallback(()=>C(!0),[]),onCustomAnchorRemove:u.useCallback(()=>C(!1),[]),modal:i,children:n})})};re.displayName=E;var ae="PopoverAnchor",Be=u.forwardRef((r,l)=>{const{__scopePopover:n,...c}=r,t=j(ae,n),a=S(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:d}=t;return u.useEffect(()=>(i(),()=>d()),[i,d]),e.jsx(X,{...a,...c,ref:l})});Be.displayName=ae;var oe="PopoverTrigger",ne=u.forwardRef((r,l)=>{const{__scopePopover:n,...c}=r,t=j(oe,n),a=S(n),i=Y(l,t.triggerRef),d=e.jsx(se.button,{type:"button","aria-haspopup":"dialog","aria-expanded":t.open,"aria-controls":t.contentId,"data-state":ue(t.open),...c,ref:i,onClick:A(r.onClick,t.onOpenToggle)});return t.hasCustomAnchor?d:e.jsx(X,{asChild:!0,...a,children:d})});ne.displayName=oe;var T="PopoverPortal",[ze,Ge]=te(T,{forceMount:void 0}),le=r=>{const{__scopePopover:l,forceMount:n,children:c,container:t}=r,a=j(T,l);return e.jsx(ze,{scope:l,forceMount:n,children:e.jsx(ee,{present:n||a.open,children:e.jsx(Ne,{asChild:!0,container:t,children:c})})})};le.displayName=T;var _="PopoverContent",ce=u.forwardRef((r,l)=>{const n=Ge(_,r.__scopePopover),{forceMount:c=n.forceMount,...t}=r,a=j(_,r.__scopePopover);return e.jsx(ee,{present:c||a.open,children:a.modal?e.jsx(Ke,{...t,ref:l}):e.jsx(Ue,{...t,ref:l})})});ce.displayName=_;var Je=Oe("PopoverContent.RemoveScroll"),Ke=u.forwardRef((r,l)=>{const n=j(_,r.__scopePopover),c=u.useRef(null),t=Y(l,c),a=u.useRef(!1);return u.useEffect(()=>{const i=c.current;if(i)return be(i)},[]),e.jsx(ye,{as:Je,allowPinchZoom:!0,children:e.jsx(ie,{...r,ref:t,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:A(r.onCloseAutoFocus,i=>{i.preventDefault(),a.current||n.triggerRef.current?.focus()}),onPointerDownOutside:A(r.onPointerDownOutside,i=>{const d=i.detail.originalEvent,h=d.button===0&&d.ctrlKey===!0,N=d.button===2||h;a.current=N},{checkForDefaultPrevented:!1}),onFocusOutside:A(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ue=u.forwardRef((r,l)=>{const n=j(_,r.__scopePopover),c=u.useRef(!1),t=u.useRef(!1);return e.jsx(ie,{...r,ref:l,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{r.onCloseAutoFocus?.(a),a.defaultPrevented||(c.current||n.triggerRef.current?.focus(),a.preventDefault()),c.current=!1,t.current=!1},onInteractOutside:a=>{r.onInteractOutside?.(a),a.defaultPrevented||(c.current=!0,a.detail.originalEvent.type==="pointerdown"&&(t.current=!0));const i=a.target;n.triggerRef.current?.contains(i)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&t.current&&a.preventDefault()}})}),ie=u.forwardRef((r,l)=>{const{__scopePopover:n,trapFocus:c,onOpenAutoFocus:t,onCloseAutoFocus:a,disableOutsidePointerEvents:i,onEscapeKeyDown:d,onPointerDownOutside:h,onFocusOutside:N,onInteractOutside:C,...b}=r,f=j(_,n),g=S(n);return Ce(),e.jsx(Pe,{asChild:!0,loop:!0,trapped:c,onMountAutoFocus:t,onUnmountAutoFocus:a,children:e.jsx(_e,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:C,onEscapeKeyDown:d,onPointerDownOutside:h,onFocusOutside:N,onDismiss:()=>f.onOpenChange(!1),children:e.jsx(we,{"data-state":ue(f.open),role:"dialog",id:f.contentId,...g,...b,ref:l,style:{...b.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),de="PopoverClose",qe=u.forwardRef((r,l)=>{const{__scopePopover:n,...c}=r,t=j(de,n);return e.jsx(se.button,{type:"button",...c,ref:l,onClick:A(r.onClick,()=>t.onOpenChange(!1))})});qe.displayName=de;var We="PopoverArrow",Ze=u.forwardRef((r,l)=>{const{__scopePopover:n,...c}=r,t=S(n);return e.jsx(Ae,{...t,...c,ref:l})});Ze.displayName=We;function ue(r){return r?"open":"closed"}var Qe=re,Xe=ne,Ye=le,es=ce;function ss({...r}){return e.jsx(Qe,{"data-slot":"popover",...r})}function ts({...r}){return e.jsx(Xe,{"data-slot":"popover-trigger",...r})}function rs({className:r,align:l="center",sideOffset:n=4,...c}){return e.jsx(Ye,{children:e.jsx(es,{"data-slot":"popover-content",align:l,sideOffset:n,className:Fe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",r),...c})})}const as=[{title:"Form Entries",href:"/form-entries"}];function ws({entries:r={},needs:l=[],predefinedNeeds:n=[],otherNeeds:c=[],filters:t={}}){const[a,i]=u.useState(()=>t?.needs?(Array.isArray(t.needs)?t.needs:[t.needs]).map(o=>parseInt(String(o))).filter(o=>!isNaN(o)):[]),[d,h]=u.useState({entry_number:t?.entry_number||"",submitter_name:t?.submitter_name||"",location:t?.location||"all",status:t?.status||"all"}),[N,C]=u.useState(!1),b=Array.isArray(r?.data)?r.data:[],f=Array.isArray(r?.links)?r.links:[],g=Array.isArray(l)?l:[],k=Array.isArray(n)?n:[],w=Array.isArray(c)?c:[],H=b.length===0;u.useEffect(()=>{if(!t?.needs){i([]);return}const o=(Array.isArray(t.needs)?t.needs:[t.needs]).map(m=>parseInt(String(m))).filter(m=>!isNaN(m));i(o)},[t?.needs]),u.useEffect(()=>{h({entry_number:t?.entry_number||"",submitter_name:t?.submitter_name||"",location:t?.location||"all",status:t?.status||"all"})},[t]);const y=(s={})=>{const o={...d,needs:a.length>0?a:void 0,...s};Object.keys(o).forEach(m=>{const p=o[m];(p===""||p==="all"||Array.isArray(p)&&p.length===0)&&delete o[m]}),s.hasOwnProperty("page")||delete o.page,B.get("/form-entries",o,{preserveState:!0,preserveScroll:!0})},V=()=>{i([]),h({entry_number:"",submitter_name:"",location:"all",status:"all"}),B.get("/form-entries",{},{preserveState:!1,preserveScroll:!1})},D=(s,o)=>{const m=o?[...a,s]:a.filter(p=>p!==s);i(m)},me=s=>{const o=w.map(p=>p.id);let m;if(s){const p=o.filter(L=>!a.includes(L));m=[...a,...p]}else m=a.filter(p=>!o.includes(p));i(m)},R=(s,o)=>{h(m=>({...m,[s]:o}))},I=s=>{if(!s)return;const m=new URL(s).searchParams.get("page");y({page:m||1})},pe=()=>g.filter(s=>a.includes(s.id)).map(s=>s.name_ar),he=()=>d.entry_number!==(t?.entry_number||"")||d.submitter_name!==(t?.submitter_name||"")||d.location!==(t?.location||"all")||d.status!==(t?.status||"all")||JSON.stringify(a)!==JSON.stringify(Array.isArray(t?.needs)?t.needs.map(s=>parseInt(String(s))).filter(s=>!isNaN(s)):t?.needs?[parseInt(String(t.needs))].filter(s=>!isNaN(s)):[]),xe=a.length>0||Object.entries(t).some(([s,o])=>!o||o==="all"?!1:Array.isArray(o)?o.length>0:typeof o=="string"?o.trim()!=="":!0);return e.jsxs(Se,{breadcrumbs:as,children:[e.jsx(fe,{title:"Form Entries"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Form Entries"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:H?"No entries found":`Showing ${r?.from??"N/A"}-${r?.to??"N/A"} of ${r?.total??0} entries`})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("a",{href:"/form-entries/export",children:e.jsxs(x,{variant:"secondary",className:"gap-1",children:[e.jsx(He,{className:"h-4 w-4"})," Export"]})})})]}),e.jsx(M,{className:"overflow-hidden",children:e.jsxs($,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[e.jsx(G,{placeholder:"Entry Number",value:d.entry_number,onChange:s=>R("entry_number",s.target.value),className:"w-full"}),e.jsx(G,{placeholder:"Submitter Name",value:d.submitter_name,onChange:s=>R("submitter_name",s.target.value),className:"w-full"}),e.jsxs(J,{value:d.location,onValueChange:s=>R("location",s),children:[e.jsx(K,{children:e.jsx(U,{placeholder:"Location"})}),e.jsxs(q,{children:[e.jsx(v,{value:"all",children:"All Locations"}),e.jsx(v,{value:"عائلة مضيفة",children:"عائلة مضيفة"}),e.jsx(v,{value:"مكان ايواء (او اجار)",children:"مكان ايواء (او اجار)"}),e.jsx(v,{value:"no-location",children:"لا يوجد"})]})]}),e.jsxs(J,{value:d.status,onValueChange:s=>R("status",s),children:[e.jsx(K,{children:e.jsx(U,{placeholder:"Status"})}),e.jsxs(q,{children:[e.jsx(v,{value:"all",children:"All Statuses"}),e.jsx(v,{value:"أسماء ضحايا",children:"أسماء ضحايا"}),e.jsx(v,{value:"منازل محترقة",children:"منازل محترقة"}),e.jsx(v,{value:"منازل مسروقة",children:"منازل مسروقة"}),e.jsx(v,{value:"نزوح",children:"نزوح"})]})]}),e.jsxs(ss,{open:N,onOpenChange:C,children:[e.jsx(ts,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"w-full justify-between",children:[e.jsx("span",{children:a.length===0?"Select Needs":`${a.length} need${a.length>1?"s":""} selected`}),e.jsx(Ee,{className:"h-4 w-4 opacity-50"})]})}),e.jsx(rs,{className:"w-80 p-4",align:"start",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Filter by Needs"}),e.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:[k.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide border-b pb-1",children:"Predefined Needs"}),k.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:`need-${s.id}`,checked:a.includes(s.id),onCheckedChange:o=>D(s.id,o)}),e.jsx(F,{htmlFor:`need-${s.id}`,className:"text-sm font-normal cursor-pointer",children:s.name_ar})]},s.id))]}),w.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide border-b pb-1",children:"Other Needs"}),e.jsxs("div",{className:"flex items-center space-x-2 bg-muted/50 p-2 rounded",children:[e.jsx(O,{id:"select-all-others",checked:w.every(s=>a.includes(s.id)),onCheckedChange:s=>me(s)}),e.jsx(F,{htmlFor:"select-all-others",className:"text-sm font-medium cursor-pointer",children:"Other (Select All)"})]}),w.map(s=>e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(O,{id:`need-${s.id}`,checked:a.includes(s.id),onCheckedChange:o=>D(s.id,o)}),e.jsx(F,{htmlFor:`need-${s.id}`,className:"text-sm font-normal cursor-pointer",children:s.name_ar})]},s.id))]}),k.length===0&&w.length===0&&g.length>0&&e.jsx("div",{className:"space-y-2",children:g.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:`need-${s.id}`,checked:a.includes(s.id),onCheckedChange:o=>D(s.id,o)}),e.jsx(F,{htmlFor:`need-${s.id}`,className:"text-sm font-normal cursor-pointer",children:s.name_ar})]},s.id))})]})]})})})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(x,{onClick:()=>y(),className:"gap-1",disabled:!he(),children:[e.jsx(Ie,{className:"h-4 w-4"})," Apply Filters"]}),e.jsxs(x,{variant:"outline",onClick:V,className:"gap-1",children:[e.jsx(W,{className:"h-4 w-4"})," Reset"]})]})]})}),xe&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t?.entry_number&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Entry: ",t.entry_number,e.jsx("button",{onClick:()=>{h(s=>({...s,entry_number:""})),y({entry_number:""})},className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),t?.submitter_name&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Submitter: ",t.submitter_name,e.jsx("button",{onClick:()=>{h(s=>({...s,submitter_name:""})),y({submitter_name:""})},className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),t?.location&&t.location!=="all"&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Location: ",t.location,e.jsx("button",{onClick:()=>{h(s=>({...s,location:"all"})),y({location:""})},className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),t?.status&&t.status!=="all"&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Status: ",t.status,e.jsx("button",{onClick:()=>{h(s=>({...s,status:"all"})),y({status:""})},className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),pe().map((s,o)=>e.jsxs(P,{variant:"secondary",className:"gap-1",children:[s,e.jsx("button",{onClick:()=>{const m=g.find(p=>p.name_ar===s);if(m){const p=a.filter(L=>L!==m.id);i(p),y({needs:p})}},className:"ml-1 text-xs hover:text-red-500",children:"×"})]},o))]}),H?e.jsx(M,{className:"text-center",children:e.jsxs($,{className:"py-16",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-muted",children:e.jsx(Le,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx("h3",{className:"mt-3 text-lg font-medium",children:"No entries found"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Adjust your filters to see results"}),e.jsx("div",{className:"mt-4 flex justify-center gap-3",children:e.jsxs(x,{variant:"outline",onClick:V,children:[e.jsx(W,{className:"mr-2 h-4 w-4"})," Reset filters"]})})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(s=>e.jsx(M,{className:"h-full flex flex-col hover:shadow-md transition-shadow",children:e.jsxs($,{className:"p-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold leading-tight",children:["Entry #",s.entry_number]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.submitter_name||"No submitter"})]}),s.status&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.status.split(",").map((o,m)=>e.jsx(P,{variant:"outline",className:"text-xs",children:o.trim()},m))})]}),s.location&&e.jsxs("p",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.location})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Submitted: ",new Date(s.date_submitted).toLocaleDateString()]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Families"}),e.jsx("p",{children:s.hosted_families_count})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Martyrs"}),e.jsx("p",{children:s.martyrs_count})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Shelters"}),e.jsx("p",{children:s.shelters_count})]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t",children:e.jsx(ve,{href:`/form-entries/${s.id}`,className:"w-full",children:e.jsxs(x,{variant:"default",className:"w-full gap-2",children:[e.jsx($e,{className:"h-4 w-4"})," View Details"]})})})]})},s.id))}),(r?.last_page??0)>1&&e.jsxs("div",{className:"flex flex-col items-center gap-4 pt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",r?.current_page??1," of ",r?.last_page??1," (",r?.total??0," total entries)"]}),e.jsx("div",{className:"flex gap-1 flex-wrap justify-center",children:f.map((s,o)=>s.url?s.label.includes("Previous")?e.jsxs(x,{variant:"outline",onClick:()=>I(s.url),className:"gap-1",children:[e.jsx(Z,{className:"h-4 w-4"})," Previous"]},o):s.label.includes("Next")?e.jsxs(x,{variant:"outline",onClick:()=>I(s.url),className:"gap-1",children:["Next ",e.jsx(z,{className:"h-4 w-4"})]},o):e.jsx(x,{variant:s.active?"default":"outline",onClick:()=>I(s.url),className:"min-w-[40px]",children:s.label},o):s.label.includes("Previous")?e.jsxs(x,{variant:"outline",disabled:!0,className:"gap-1",children:[e.jsx(Z,{className:"h-4 w-4"})," Previous"]},o):s.label.includes("Next")?e.jsxs(x,{variant:"outline",disabled:!0,className:"gap-1",children:["Next ",e.jsx(z,{className:"h-4 w-4"})]},o):null)})]})]})]})}export{ws as default};
