import{r as d,j as e,H as ae,L as re,a as S}from"./app-kFe3W52v.js";import{c as B,R as oe,u as ne,a as H,P as le,h as ce,b as ie,d as de,F as ue,D as pe,C as me,e as xe,A as he,f as F}from"./app-layout-CeMAjsTz.js";import{c as fe,u as z,a as ve,b as ge,B as m}from"./button-CjP7rKh3.js";import{I as D}from"./input-BgsbDBET.js";import{S as I,a as M,b as L,c as T,d as h,C as je}from"./select-oXQEokxY.js";import{B as P}from"./badge-f65TfQO7.js";import{C as A,c as O}from"./card-C2Q4dehj.js";import{C as Ne}from"./checkbox-BKqEJ5F5.js";import{L as Ce}from"./label-XQbIVQar.js";import{u as Pe,c as be,a as y,P as G}from"./index-DM-IqmN2.js";import{P as K}from"./index-DGqGJZ-A.js";import{R as $}from"./rotate-ccw-CUpgzOHS.js";import{F as we}from"./file-text-Cy0kkOBC.js";import{M as ye}from"./map-pin-Bz-tpcHY.js";import{E as _e}from"./eye-BaSUxmf4.js";import{C as V}from"./chevron-left-50bH4gFX.js";/* empty css            */import"./index-CMYKVjK-.js";import"./check-tbrJmj50.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Se=fe("Download",Re);var R="Popover",[U,ps]=be(R,[B]),_=B(),[Ae,v]=U(R),q=a=>{const{__scopePopover:l,children:t,open:r,defaultOpen:o,onOpenChange:n,modal:i=!1}=a,c=_(l),f=d.useRef(null),[g,j]=d.useState(!1),[N,x]=Pe({prop:r,defaultProp:o??!1,onChange:n,caller:R});return e.jsx(oe,{...c,children:e.jsx(Ae,{scope:l,contentId:ne(),triggerRef:f,open:N,onOpenChange:x,onOpenToggle:d.useCallback(()=>x(w=>!w),[x]),hasCustomAnchor:g,onCustomAnchorAdd:d.useCallback(()=>j(!0),[]),onCustomAnchorRemove:d.useCallback(()=>j(!1),[]),modal:i,children:t})})};q.displayName=R;var J="PopoverAnchor",Oe=d.forwardRef((a,l)=>{const{__scopePopover:t,...r}=a,o=v(J,t),n=_(t),{onCustomAnchorAdd:i,onCustomAnchorRemove:c}=o;return d.useEffect(()=>(i(),()=>c()),[i,c]),e.jsx(H,{...n,...r,ref:l})});Oe.displayName=J;var W="PopoverTrigger",Z=d.forwardRef((a,l)=>{const{__scopePopover:t,...r}=a,o=v(W,t),n=_(t),i=z(l,o.triggerRef),c=e.jsx(K.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":se(o.open),...r,ref:i,onClick:y(a.onClick,o.onOpenToggle)});return o.hasCustomAnchor?c:e.jsx(H,{asChild:!0,...n,children:c})});Z.displayName=W;var E="PopoverPortal",[Ee,ke]=U(E,{forceMount:void 0}),Q=a=>{const{__scopePopover:l,forceMount:t,children:r,container:o}=a,n=v(E,l);return e.jsx(Ee,{scope:l,forceMount:t,children:e.jsx(G,{present:t||n.open,children:e.jsx(le,{asChild:!0,container:o,children:r})})})};Q.displayName=E;var b="PopoverContent",X=d.forwardRef((a,l)=>{const t=ke(b,a.__scopePopover),{forceMount:r=t.forceMount,...o}=a,n=v(b,a.__scopePopover);return e.jsx(G,{present:r||n.open,children:n.modal?e.jsx(De,{...o,ref:l}):e.jsx(Ie,{...o,ref:l})})});X.displayName=b;var Fe=ve("PopoverContent.RemoveScroll"),De=d.forwardRef((a,l)=>{const t=v(b,a.__scopePopover),r=d.useRef(null),o=z(l,r),n=d.useRef(!1);return d.useEffect(()=>{const i=r.current;if(i)return ce(i)},[]),e.jsx(ie,{as:Fe,allowPinchZoom:!0,children:e.jsx(Y,{...a,ref:o,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:y(a.onCloseAutoFocus,i=>{i.preventDefault(),n.current||t.triggerRef.current?.focus()}),onPointerDownOutside:y(a.onPointerDownOutside,i=>{const c=i.detail.originalEvent,f=c.button===0&&c.ctrlKey===!0,g=c.button===2||f;n.current=g},{checkForDefaultPrevented:!1}),onFocusOutside:y(a.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ie=d.forwardRef((a,l)=>{const t=v(b,a.__scopePopover),r=d.useRef(!1),o=d.useRef(!1);return e.jsx(Y,{...a,ref:l,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{a.onCloseAutoFocus?.(n),n.defaultPrevented||(r.current||t.triggerRef.current?.focus(),n.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:n=>{a.onInteractOutside?.(n),n.defaultPrevented||(r.current=!0,n.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=n.target;t.triggerRef.current?.contains(i)&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&o.current&&n.preventDefault()}})}),Y=d.forwardRef((a,l)=>{const{__scopePopover:t,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:n,disableOutsidePointerEvents:i,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:g,onInteractOutside:j,...N}=a,x=v(b,t),w=_(t);return de(),e.jsx(ue,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:n,children:e.jsx(pe,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:j,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:g,onDismiss:()=>x.onOpenChange(!1),children:e.jsx(me,{"data-state":se(x.open),role:"dialog",id:x.contentId,...w,...N,ref:l,style:{...N.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ee="PopoverClose",Me=d.forwardRef((a,l)=>{const{__scopePopover:t,...r}=a,o=v(ee,t);return e.jsx(K.button,{type:"button",...r,ref:l,onClick:y(a.onClick,()=>o.onOpenChange(!1))})});Me.displayName=ee;var Le="PopoverArrow",Te=d.forwardRef((a,l)=>{const{__scopePopover:t,...r}=a,o=_(t);return e.jsx(xe,{...o,...r,ref:l})});Te.displayName=Le;function se(a){return a?"open":"closed"}var $e=q,Ve=Z,Be=Q,He=X;function ze({...a}){return e.jsx($e,{"data-slot":"popover",...a})}function Ge({...a}){return e.jsx(Ve,{"data-slot":"popover-trigger",...a})}function Ke({className:a,align:l="center",sideOffset:t=4,...r}){return e.jsx(Be,{children:e.jsx(He,{"data-slot":"popover-content",align:l,sideOffset:t,className:ge("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",a),...r})})}const Ue=[{title:"Form Entries",href:"/form-entries"}];function ms({entries:a,needs:l,filters:t={}}){const[r,o]=d.useState(()=>t?.needs?t.needs.map(s=>parseInt(String(s))):[]),[n,i]=d.useState(!1);d.useEffect(()=>{const s=t?.needs?t.needs.map(u=>parseInt(String(u))):[];o(s)},[JSON.stringify(t?.needs)]);const c=(s={})=>{const u={...t,...s};s.hasOwnProperty("page")||delete u.page,s.hasOwnProperty("needs")&&o(s.needs||[]),S.get("/form-entries",u,{preserveState:!0,preserveScroll:!0,replace:!1,onSuccess:()=>{s.hasOwnProperty("needs")&&o(s.needs||[])}})},f=()=>{o([]),S.get("/form-entries",{},{preserveState:!1,preserveScroll:!1})},g=(s,u)=>{let p;u?p=[...r,s]:p=r.filter(C=>C!==s),o(p),c({needs:p})},j=()=>{c({needs:r}),i(!1)},N=()=>{o([]),c({needs:[]}),i(!1)},x=s=>{if(!s)return;const p=new URL(s).searchParams.get("page");S.get("/form-entries",{...t,page:p||1},{preserveState:!0,preserveScroll:!1})},w=()=>l.filter(s=>r.includes(s.id)).map(s=>s.name_ar),k=a.data.length===0;return e.jsxs(he,{breadcrumbs:Ue,children:[e.jsx(ae,{title:"Form Entries"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Form Entries"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:k?"No entries found":`Showing ${a.from??"N/A"}-${a.to??"N/A"} of ${a.total} entries`})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("a",{href:"/form-entries/export",children:e.jsxs(m,{variant:"secondary",className:"gap-1",children:[e.jsx(Se,{className:"h-4 w-4"})," Export"]})})})]}),e.jsx(A,{className:"overflow-hidden",children:e.jsxs(O,{className:"p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-3",children:[e.jsx("div",{className:"lg:col-span-1 flex gap-2",children:e.jsxs(m,{variant:"outline",onClick:f,className:"gap-1",children:[e.jsx($,{className:"h-4 w-4"})," Reset"]})}),e.jsx(D,{placeholder:"Entry Number",defaultValue:t?.entry_number||"",onBlur:s=>c({entry_number:s.target.value}),className:"w-full"}),e.jsx(D,{placeholder:"Submitter Name",defaultValue:t?.submitter_name||"",onBlur:s=>c({submitter_name:s.target.value}),className:"w-full"}),e.jsxs(I,{value:t?.location||"all",onValueChange:s=>c({location:s==="all"?"":s}),children:[e.jsx(M,{children:e.jsx(L,{placeholder:"Location"})}),e.jsxs(T,{children:[e.jsx(h,{value:"all",children:"All Locations"}),e.jsx(h,{value:"عائلة مضيفة",children:"عائلة مضيفة"}),e.jsx(h,{value:"مكان ايواء (او اجار)",children:"مكان ايواء (او اجار)"}),e.jsx(h,{value:"no-location",children:"لا يوجد"})]})]}),e.jsxs(I,{value:t?.status||"all",onValueChange:s=>c({status:s==="all"?"":s}),children:[e.jsx(M,{children:e.jsx(L,{placeholder:"Status"})}),e.jsxs(T,{children:[e.jsx(h,{value:"all",children:"All Statuses"}),e.jsx(h,{value:"أسماء ضحايا",children:"أسماء ضحايا"}),e.jsx(h,{value:"منازل محترقة",children:"منازل محترقة"}),e.jsx(h,{value:"منازل مسروقة",children:"منازل مسروقة"}),e.jsx(h,{value:"نزوح",children:"نزوح"})]})]}),e.jsxs(ze,{open:n,onOpenChange:i,children:[e.jsx(Ge,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"w-full justify-between",children:[e.jsx("span",{children:r.length===0?"Select Needs":`${r.length} need${r.length>1?"s":""} selected`}),e.jsx(je,{className:"h-4 w-4 opacity-50"})]})}),e.jsx(Ke,{className:"w-80 p-4",align:"start",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Filter by Needs"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:l.map(s=>{const u=r.includes(s.id);return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{id:`need-${s.id}`,checked:u,onCheckedChange:p=>g(s.id,p)}),e.jsx(Ce,{htmlFor:`need-${s.id}`,className:"text-sm font-normal cursor-pointer",children:s.name_ar})]},s.id)})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(m,{onClick:j,className:"flex-1",size:"sm",children:"Apply Filter"}),e.jsx(m,{variant:"outline",onClick:N,size:"sm",children:"Clear"})]})]})})]})]})}),(r.length>0||Object.values(t).some(s=>s&&s!=="all"&&(Array.isArray(s)?s.length>0:!0)))&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t?.entry_number&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Entry: ",t.entry_number,e.jsx("button",{onClick:()=>c({entry_number:""}),className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),t?.submitter_name&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Submitter: ",t.submitter_name,e.jsx("button",{onClick:()=>c({submitter_name:""}),className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),t?.location&&t.location!=="all"&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Location: ",t.location,e.jsx("button",{onClick:()=>c({location:""}),className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),t?.status&&t.status!=="all"&&e.jsxs(P,{variant:"secondary",className:"gap-1",children:["Status: ",t.status,e.jsx("button",{onClick:()=>c({status:""}),className:"ml-1 text-xs hover:text-red-500",children:"×"})]}),w().map((s,u)=>e.jsxs(P,{variant:"secondary",className:"gap-1",children:[s,e.jsx("button",{onClick:()=>{const p=l.find(C=>C.name_ar===s);if(p){const C=r.filter(te=>te!==p.id);o(C),c({needs:C})}},className:"ml-1 text-xs hover:text-red-500",children:"×"})]},u))]}),k?e.jsx(A,{className:"text-center",children:e.jsxs(O,{className:"py-16",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-muted",children:e.jsx(we,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx("h3",{className:"mt-3 text-lg font-medium",children:"No entries found"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Adjust your filters to see results"}),e.jsx("div",{className:"mt-4 flex justify-center gap-3",children:e.jsxs(m,{variant:"outline",onClick:f,children:[e.jsx($,{className:"mr-2 h-4 w-4"})," Reset filters"]})})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.data.map(s=>e.jsx(A,{className:"h-full flex flex-col hover:shadow-md transition-shadow",children:e.jsxs(O,{className:"p-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold leading-tight",children:["Entry #",s.entry_number]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.submitter_name||"No submitter"})]}),s.status&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.status.split(",").map((u,p)=>e.jsx(P,{variant:"outline",className:"text-xs",children:u.trim()},p))})]}),s.location&&e.jsxs("p",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.location})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Submitted: ",new Date(s.date_submitted).toLocaleDateString()]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Families"}),e.jsx("p",{children:s.hosted_families_count})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Martyrs"}),e.jsx("p",{children:s.martyrs_count})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Shelters"}),e.jsx("p",{children:s.shelters_count})]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t",children:e.jsx(re,{href:`/form-entries/${s.id}`,className:"w-full",children:e.jsxs(m,{variant:"default",className:"w-full gap-2",children:[e.jsx(_e,{className:"h-4 w-4"})," View Details"]})})})]})},s.id))}),a.last_page>1&&e.jsxs("div",{className:"flex flex-col items-center gap-4 pt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",a.current_page," of ",a.last_page," (",a.total," total entries)"]}),e.jsx("div",{className:"flex gap-1 flex-wrap justify-center",children:a.links.map((s,u)=>s.url?s.label.includes("Previous")?e.jsxs(m,{variant:"outline",onClick:()=>x(s.url),className:"gap-1",children:[e.jsx(V,{className:"h-4 w-4"}),"Previous"]},u):s.label.includes("Next")?e.jsxs(m,{variant:"outline",onClick:()=>x(s.url),className:"gap-1",children:["Next",e.jsx(F,{className:"h-4 w-4"})]},u):e.jsx(m,{variant:s.active?"default":"outline",onClick:()=>x(s.url),className:"min-w-[40px]",children:s.label},u):s.label.includes("Previous")?e.jsxs(m,{variant:"outline",disabled:!0,className:"gap-1",children:[e.jsx(V,{className:"h-4 w-4"}),"Previous"]},u):s.label.includes("Next")?e.jsxs(m,{variant:"outline",disabled:!0,className:"gap-1",children:["Next",e.jsx(F,{className:"h-4 w-4"})]},u):null)})]})]})]})}export{ms as default};
